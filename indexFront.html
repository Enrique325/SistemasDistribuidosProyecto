<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoteles Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: wheat;
        }
        h1 {
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: auto;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        select, input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #map {
            width: 100%;
            height: 400px;
            margin-bottom: 20px;
        }
        #weather {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background: #f4fcfd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hoteles Tracker</h1>
        <div class="form-group">
            <label for="currency">Selecciona tu tipo de moneda</label>
            <select id="currency">
                <option value="MXN">MXN</option>
                <option value="USD">USD</option>
            </select>
        </div>
        <div class="form-group">
            <label for="destination">Ingrese su destino donde viajará</label>
            <input type="text" id="destination" placeholder="Destino">
        </div>
        <div id="map"></div>
        <div id="weather">
            <h3>Clima actual</h3>
            <p id="weather-info">Cargando clima...</p>
        </div>
    </div>

    <script>
        function initMap() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    const map = new google.maps.Map(document.getElementById('map'), {
                        center: pos,
                        zoom: 15
                    });
                    const marker = new google.maps.Marker({
                        position: pos,
                        map: map
                    });

                    fetchWeather(pos.lat, pos.lng);
                }, () => {
                    handleLocationError(true, map.getCenter());
                });
            } else {
                handleLocationError(false, map.getCenter());
            }
        }

        function handleLocationError(browserHasGeolocation, pos) {
            const map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: -34.397, lng: 150.644},
                zoom: 6
            });
            const infoWindow = new google.maps.InfoWindow({
                position: pos,
                content: browserHasGeolocation ?
                    'Error: The Geolocation service failed.' :
                    'Error: Your browser doesn\'t support geolocation.'
            });
            infoWindow.open(map);
        }

        function fetchWeather(lat, lon) {
            const apiKey = 'da89341e8414fcbf56e17074620471f4';
            const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=es&appid=${apiKey}`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    const weatherInfo = `Ubicación: ${data.name}, ${data.sys.country}<br>
                                         Temperatura: ${data.main.temp}°C<br>
                                         Clima: ${data.weather[0].description}`;
                    document.getElementById('weather-info').innerHTML = weatherInfo;
                })
                .catch(error => {
                    document.getElementById('weather-info').textContent = 'Error al obtener el clima';
                    console.error('Error fetching weather:', error);
                });
        }

        // Load the Google Maps script asynchronously
        function loadScript() {
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=AIzaSyBDaeWicvigtP9xPv919E-RNoxfvC-Hqik&callback=initMap`;
            script.async = true;
            script.defer = true;
            document.head.appendChild(script);
        }

        document.addEventListener('DOMContentLoaded', loadScript);
    </script>
</body>
</html>
